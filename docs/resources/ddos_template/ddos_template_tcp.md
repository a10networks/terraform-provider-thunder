---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "thunder_ddos_template_tcp Resource - terraform-provider-thunder"
subcategory: ""
description: |-
  thunder_ddos_template_tcp: TCP template Configuration
  PLACEHOLDER
---

# thunder_ddos_template_tcp (Resource)

`thunder_ddos_template_tcp`: TCP template Configuration

__PLACEHOLDER__

## Example Usage

```terraform
provider "thunder" {
  address  = var.dut9049
  username = var.username
  password = var.password
}
resource "thunder_ddos_template_tcp" "thunder_ddos_template_tcp" {
  name = "test"
  action_cfg {
    action_on_ack      = 1
    reset              = 1
    timeout            = 3
    min_retry_gap      = 2
    authenticate_only  = 1
    rto_authentication = 1
  }
  action_on_syn_rto_retry_count = 3
  action_on_ack_rto_retry_count = 3
  age                           = 4
  black_list_out_of_seq         = 33
  black_list_retransmit         = 33
  black_list_zero_win           = 44
  syn_auth                      = "send-rst"
  conn_rate_limit_on_syn_only   = 1
  per_conn_rate_interval        = "1sec"
  per_conn_pkt_rate_limit       = 3
  per_conn_pkt_rate_action      = "drop"
  dst {
    rate_limit {
      syn_rate_limit {
        dst_syn_rate_action = "drop"
      }
    }
  }
  src {
    rate_limit {
      syn_rate_limit {
        src_syn_rate_action = "drop"
      }
    }
  }
  allow_synack_skip_authentications = 1
  synack_rate_limit                 = 3
  allow_syn_otherflags              = 1
  allow_tcp_tfo                     = 1
  drop_known_resp_src_port_cfg {
    drop_known_resp_src_port = 1
    exclude_src_resp_port    = 1
  }
  tunnel_encap {
    gre_cfg {
      gre_encap = 1
      gre_always {
        gre_ipv4              = "10.10.10.10"
        preserve_src_ipv4_gre = 1
      }
    }
  }

  user_tag = "test"
  progression_tracking {
    progression_tracking_enabled = "enable-check"
    violation                    = 3
    progression_tracking_action  = "drop"

    connection_tracking {
      progression_tracking_conn_enabled = "enable-check"
      conn_sent_max                     = 10
      conn_sent_min                     = 8
      conn_rcvd_max                     = 10
      conn_rcvd_min                     = 8
      conn_rcvd_sent_ratio_min          = 18
      conn_rcvd_sent_ratio_max          = 20
      conn_duration_max                 = 22
      conn_duration_min                 = 3
      conn_violation                    = 3
      progression_tracking_conn_action  = "drop"

    }
  }
  filter_list {
    tcp_filter_seq       = 3
    tcp_filter_regex     = "test"
    tcp_filter_unmatched = 1
    tcp_filter_action    = "count-only"

    user_tag = "test"
  }

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String)

### Optional

- `ack_authentication_synack_reset` (Number) Enable Reset client TCP SYN+ACK for authentication (DST support only)
- `action_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--action_cfg))
- `action_on_ack_rto_retry_count` (Number) Take action if action-on-ack RTO-authentication fail over retry time(default:5)
- `action_on_syn_rto_retry_count` (Number) Take action if action-on-syn RTO-authentication fail over retry time(default:5)
- `action_syn_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--action_syn_cfg))
- `age` (Number) Session age in minutes
- `allow_ra` (Number) Allow RA packets to be used for auth
- `allow_syn_otherflags` (Number) Treat TCP SYN+PSH as a TCP SYN (DST tcp ports support only)
- `allow_synack_skip_authentications` (Number) Allow create sessions on SYNACK without syn-auth and ack-auth (ASYM Mode only)
- `allow_tcp_tfo` (Number) Allow TCP Fast Open
- `black_list_out_of_seq` (Number) Black list Src IP if out of seq pkts exceed configured threshold
- `black_list_retransmit` (Number) Black list Src IP if retransmit pkts exceed configured threshold
- `black_list_zero_win` (Number) Black list Src IP if zero window pkts exceed configured threshold
- `conn_rate_limit_on_syn_only` (Number) Only count SYN-initiated connections towards connection-rate tracking
- `create_conn_on_syn_only` (Number) Enable connection establishment on SYN only
- `drop_known_resp_src_port_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--drop_known_resp_src_port_cfg))
- `dst` (Block List, Max: 1) (see [below for nested schema](#nestedblock--dst))
- `filter_list` (Block List) (see [below for nested schema](#nestedblock--filter_list))
- `per_conn_out_of_seq_rate_action` (String) 'drop': Drop packets for out-of-seq rate exceed (Default); 'blacklist-src': help Blacklist-src for out-of-seq rate exceed; 'ignore': help Ignore out-of-seq rate exceed;
- `per_conn_out_of_seq_rate_limit` (Number) Take action if out-of-seq pkt rate exceed configured threshold
- `per_conn_pkt_rate_action` (String) 'drop': Drop packets for per-conn-pkt-rate exceed (Default); 'blacklist-src': help Blacklist-src for per-conn-pkt-rate exceed; 'ignore': Ignore per-conn-pkt-rate-exceed;
- `per_conn_pkt_rate_limit` (Number) Packet rate limit per connection per rate-interval
- `per_conn_rate_interval` (String) '100ms': 100ms; '1sec': 1sec; '10sec': 10sec;
- `per_conn_retransmit_rate_action` (String) 'drop': Drop packets for retransmit rate exceed (Default); 'blacklist-src': help Blacklist-src for retransmit rate exceed; 'ignore': help Ignore retransmit rate exceed;
- `per_conn_retransmit_rate_limit` (Number) Take action if retransmit pkt rate exceed configured threshold
- `per_conn_zero_win_rate_action` (String) 'drop': Drop packets for zero-win rate exceed (Default); 'blacklist-src': help Blacklist-src for zero-win rate exceed; 'ignore': help Ignore zero-win rate exceed;
- `per_conn_zero_win_rate_limit` (Number) Take action if zero window pkt rate exceed configured threshold
- `progression_tracking` (Block List, Max: 1) (see [below for nested schema](#nestedblock--progression_tracking))
- `src` (Block List, Max: 1) (see [below for nested schema](#nestedblock--src))
- `syn_auth` (String) 'send-rst': Send RST to all client's concurrent auth attempts; 'force-rst-by-ack': Force client RST via the use of ACK; 'force-rst-by-synack': Force client RST via the use of bad SYN|ACK; 'disable': Disable TCP SYN Authentication; 'send-rst-once': Send RST to one client's concurrent auth attempts;
- `syn_cookie` (Number) Enable SYN Cookie
- `synack_rate_limit` (Number) Config SYNACK rate limit
- `track_together_with_syn` (Number) SYNACK will be counted in Dst Syn-rate limit
- `tunnel_encap` (Block List, Max: 1) (see [below for nested schema](#nestedblock--tunnel_encap))
- `user_tag` (String) Customized tag
- `uuid` (String) uuid of the object

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--action_cfg"></a>
### Nested Schema for `action_cfg`

Optional:

- `action_on_ack` (Number) Monitor tcp ack for age-out session
- `authenticate_only` (Number) Apply action-on-ack once per source address for authentication purpose
- `min_retry_gap` (Number) Min gap between 2 ACKs for action-on-ack pass in 100ms interval
- `reset` (Number) Send RST to client
- `rto_authentication` (Number) Estimate the RTO and apply the exponential back-off for authentication
- `timeout` (Number) ACK retry timeout in sec


<a id="nestedblock--action_syn_cfg"></a>
### Nested Schema for `action_syn_cfg`

Optional:

- `action_on_syn` (Number) Monitor tcp syn for age-out session
- `action_on_syn_gap` (Number) Min gap between 2 SYNs for action-on-syn pass in 100ms interval
- `action_on_syn_reset` (Number) Send RST to client
- `action_on_syn_rto` (Number) Estimate the RTO and apply the exponential back-off for authentication
- `action_on_syn_timeout` (Number) SYN retry timeout in sec


<a id="nestedblock--drop_known_resp_src_port_cfg"></a>
### Nested Schema for `drop_known_resp_src_port_cfg`

Optional:

- `drop_known_resp_src_port` (Number) Drop well-known if src-port is less than 1024
- `exclude_src_resp_port` (Number) excluding src port equal destination port


<a id="nestedblock--dst"></a>
### Nested Schema for `dst`

Optional:

- `rate_limit` (Block List, Max: 1) (see [below for nested schema](#nestedblock--dst--rate_limit))

<a id="nestedblock--dst--rate_limit"></a>
### Nested Schema for `dst.rate_limit`

Optional:

- `syn_rate_limit` (Block List, Max: 1) (see [below for nested schema](#nestedblock--dst--rate_limit--syn_rate_limit))

<a id="nestedblock--dst--rate_limit--syn_rate_limit"></a>
### Nested Schema for `dst.rate_limit.syn_rate_limit`

Optional:

- `dst_syn_rate_action` (String) 'drop': Drop packets for syn-rate exceed (Default); 'ignore': Ignore syn-rate-exceed;
- `dst_syn_rate_limit` (Number)




<a id="nestedblock--filter_list"></a>
### Nested Schema for `filter_list`

Required:

- `tcp_filter_seq` (Number) Sequence number

Optional:

- `byte_offset_filter` (String) Filter Expression using Berkeley Packet Filter syntax
- `tcp_filter_action` (String) 'blacklist-src': Also blacklist the source when action is taken; 'whitelist-src': Whitelist the source after filter passes, packets are dropped until then; 'count-only': Take no action and continue processing the next filter;
- `tcp_filter_regex` (String) Regex Expression
- `tcp_filter_unmatched` (Number) action taken when it does not match
- `user_tag` (String) Customized tag
- `uuid` (String) uuid of the object


<a id="nestedblock--progression_tracking"></a>
### Nested Schema for `progression_tracking`

Optional:

- `connection_tracking` (Block List, Max: 1) (see [below for nested schema](#nestedblock--progression_tracking--connection_tracking))
- `first_request_max_time` (Number) Set the maximum wait time from connection creation until the first data is transmitted over the connection (100 ms)
- `profiling_connection_life_model` (Number) Enable auto-config progression tracking learning for connection model
- `profiling_request_response_model` (Number) Enable auto-config progression tracking learning for request response model
- `profiling_time_window_model` (Number) Enable auto-config progression tracking learning for time window model
- `progression_tracking_action` (String) 'drop': Drop packets for progression tracking violation exceed (Default); 'blacklist-src': Blacklist-src for progression tracking violation exceed;
- `progression_tracking_action_list_name` (String) Configure action-list to take when progression tracking violation exceed
- `progression_tracking_enabled` (String) 'enable-check': Enable Progression Tracking Check;
- `request_length_max` (Number) Set the maximum request length
- `request_length_min` (Number) Set the minimum request length
- `request_response_model` (String) 'enable': Enable Request Response Model; 'disable': Disable Request Response Model;
- `request_to_response_max_time` (Number) Set the maximum request to response time (100 ms)
- `response_length_max` (Number) Set the maximum response length
- `response_length_min` (Number) Set the minimum response length
- `response_request_max_ratio` (Number) Set the maximum response to request ratio (in unit of 0.1% [1:1000])
- `response_request_min_ratio` (Number) Set the minimum response to request ratio (in unit of 0.1% [1:1000])
- `response_to_request_max_time` (Number) Set the maximum response to request time (100 ms)
- `time_window_tracking` (Block List, Max: 1) (see [below for nested schema](#nestedblock--progression_tracking--time_window_tracking))
- `uuid` (String) uuid of the object
- `violation` (Number) Set the violation threshold

<a id="nestedblock--progression_tracking--connection_tracking"></a>
### Nested Schema for `progression_tracking.connection_tracking`

Optional:

- `conn_duration_max` (Number) Set the maximum duration time (in unit of 100ms, up to 24 hours)
- `conn_duration_min` (Number) Set the minimum duration time (in unit of 100ms, up to 24 hours)
- `conn_rcvd_max` (Number) Set the maximum total received byte
- `conn_rcvd_min` (Number) Set the minimum total received byte
- `conn_rcvd_sent_ratio_max` (Number) Set the maximum received to sent ratio (in unit of 0.1% [1:1000])
- `conn_rcvd_sent_ratio_min` (Number) Set the minimum received to sent ratio (in unit of 0.1% [1:1000])
- `conn_sent_max` (Number) Set the maximum total sent byte
- `conn_sent_min` (Number) Set the minimum total sent byte
- `conn_violation` (Number) Set the violation threshold
- `progression_tracking_conn_action` (String) 'drop': Drop packets for progression tracking violation exceed (Default); 'blacklist-src': Blacklist-src for progression tracking violation exceed;
- `progression_tracking_conn_action_list_name` (String) Configure action-list to take when progression tracking violation exceed
- `progression_tracking_conn_enabled` (String) 'enable-check': Enable General Progression Tracking per Connection;
- `uuid` (String) uuid of the object


<a id="nestedblock--progression_tracking--time_window_tracking"></a>
### Nested Schema for `progression_tracking.time_window_tracking`

Optional:

- `progression_tracking_win_enabled` (String) 'enable-check': Enable Progression Tracking per Time Window;
- `progression_tracking_windows_action` (String) 'drop': Drop packets for progression tracking violation exceed (Default); 'blacklist-src': Blacklist-src for progression tracking violation exceed;
- `progression_tracking_windows_action_list_name` (String) Configure action-list to take when progression tracking violation exceed
- `uuid` (String) uuid of the object
- `window_rcvd_max` (Number) Set the maximum total received byte
- `window_rcvd_min` (Number) Set the minimum total received byte
- `window_rcvd_sent_ratio_max` (Number) Set the maximum received to sent ratio (in unit of 0.1% [1:1000])
- `window_rcvd_sent_ratio_min` (Number) Set the minimum received to sent ratio (in unit of 0.1% [1:1000])
- `window_sent_max` (Number) Set the maximum total sent byte
- `window_sent_min` (Number) Set the minimum total sent byte
- `window_violation` (Number) Set the violation threshold



<a id="nestedblock--src"></a>
### Nested Schema for `src`

Optional:

- `rate_limit` (Block List, Max: 1) (see [below for nested schema](#nestedblock--src--rate_limit))

<a id="nestedblock--src--rate_limit"></a>
### Nested Schema for `src.rate_limit`

Optional:

- `syn_rate_limit` (Block List, Max: 1) (see [below for nested schema](#nestedblock--src--rate_limit--syn_rate_limit))

<a id="nestedblock--src--rate_limit--syn_rate_limit"></a>
### Nested Schema for `src.rate_limit.syn_rate_limit`

Optional:

- `src_syn_rate_action` (String) 'drop': Drop packets for syn-rate exceed (Default); 'blacklist-src': Blacklist-src for syn-rate exceed; 'ignore': Ignore syn-rate-exceed;
- `src_syn_rate_limit` (Number)




<a id="nestedblock--tunnel_encap"></a>
### Nested Schema for `tunnel_encap`

Optional:

- `gre_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--tunnel_encap--gre_cfg))
- `ip_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--tunnel_encap--ip_cfg))

<a id="nestedblock--tunnel_encap--gre_cfg"></a>
### Nested Schema for `tunnel_encap.gre_cfg`

Optional:

- `gre_always` (Block List, Max: 1) (see [below for nested schema](#nestedblock--tunnel_encap--gre_cfg--gre_always))
- `gre_encap` (Number) Enable Tunnel encapsulation using GRE

<a id="nestedblock--tunnel_encap--gre_cfg--gre_always"></a>
### Nested Schema for `tunnel_encap.gre_cfg.gre_always`

Optional:

- `gre_ipv4` (String) IPv4 address (IPv6-over-IPv4 / IPv4-over-IPv6 are not supported.)
- `gre_ipv6` (String) IPv6 address (IPv6-over-IPv4 / IPv4-over-IPv6 are not supported.)
- `key_ipv4` (String) Encapsulate with key (Hexadecimal 0x0-0xFFFFFFFF,decimal 0-4294967295)
- `key_ipv6` (String) Encapsulate with key (Hexadecimal 0x0-0xFFFFFFFF,decimal 0-4294967295)
- `preserve_src_ipv4_gre` (Number) Use original source ip for encapsulation
- `preserve_src_ipv6_gre` (Number) Use original source ip for encapsulation



<a id="nestedblock--tunnel_encap--ip_cfg"></a>
### Nested Schema for `tunnel_encap.ip_cfg`

Optional:

- `always` (Block List, Max: 1) (see [below for nested schema](#nestedblock--tunnel_encap--ip_cfg--always))
- `ip_encap` (Number) Enable Tunnel encapsulation using IP in IP

<a id="nestedblock--tunnel_encap--ip_cfg--always"></a>
### Nested Schema for `tunnel_encap.ip_cfg.always`

Optional:

- `ipv4_addr` (String) IPv4 address (IPv6-over-IPv4 / IPv4-over-IPv6 are not supported.)
- `ipv6_addr` (String) IPv6 address (IPv6-over-IPv4 / IPv4-over-IPv6 are not supported.)
- `preserve_src_ipv4` (Number) Use original source ip for encapsulation
- `preserve_src_ipv6` (Number) Use original source ip for encapsulation


