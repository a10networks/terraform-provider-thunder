---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "thunder_ddos_template_http Resource - terraform-provider-thunder"
subcategory: ""
description: |-
  thunder_ddos_template_http: HTTP template Configuration
  PLACEHOLDER
---

# thunder_ddos_template_http (Resource)

`thunder_ddos_template_http`: HTTP template Configuration

__PLACEHOLDER__

## Example Usage

```terraform
provider "thunder" {
  address  = var.dut9049
  username = var.username
  password = var.password
}
resource "thunder_ddos_template_http" "thunder_ddos_template_http" {
  http_tmpl_name = "test"
  action         = "drop"
  mss_cfg {
    mss_timeout    = 1
    mss_percent    = 2
    number_packets = 22
  }
  disallow_connect_method = 1
  challenge_method        = "javascript"
  challenge_cookie_name   = "test"
  challenge_keep_cookie   = 1
  challenge_interval      = 10
  non_http_bypass         = 1
  malformed_http {
    malformed_http_enabled               = 1
    malformed_http_max_line_size         = 3
    malformed_http_max_num_headers       = 4
    malformed_http_max_req_line_size     = 22
    malformed_http_max_header_name_size  = 2
    malformed_http_max_content_length    = 3
    malformed_http_bad_chunk_mon_enabled = 1
  }
  use_hdr_ip_cfg {
    use_hdr_ip_as_source = 1
    l7_hdr_name          = "test"
  }
  request_header {
    timeout = 3
  }
  post_rate_limit = 333
  request_rate_limit {
    uri {
      contains_cfg {
        url_contains      = "test"
        url_contains_rate = 33
      }
    }
  }
  response_rate_limit {
    obj_size {
      less_cfg {
        obj_less      = 2
        obj_less_rate = 3
      }
    }
  }
  slow_read_drop {
    min_window_size  = 2
    min_window_count = 5
  }
  idle_timeout               = 2
  ignore_zero_payload        = 1
  out_of_order_queue_size    = 3
  out_of_order_queue_timeout = 3
  referer_filter {
    ref_filter_blacklist = 1
    referer_equals_cfg {
      referer_equals = "test"
    }
    referer_contains_cfg {
      referer_contains = "test"
    }
    referer_starts_cfg {
      referer_starts_with = "test"
    }
    referer_ends_cfg {
      referer_ends_with = "test"
    }
  }
  agent_filter {
    agent_filter_blacklist = 1
    agent_equals_cfg {
      agent_equals = "test"
    }
    agent_contains_cfg {
      agent_contains = "test"
    }
    agent_starts_cfg {
      agent_starts_with = "test"
    }
    agent_ends_cfg {
      agent_ends_with = "test"
    }
  }
  user_tag = "testing"
  filter_header_list {
    http_filter_header_seq       = 2
    http_filter_header_regex     = "test"
    http_filter_header_unmatched = 1
    http_filter_header_blacklist = 1
    user_tag                     = "test"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `http_tmpl_name` (String) DDOS HTTP Template Name

### Optional

- `action` (String) 'drop': Drop packets for the connection; 'reset': Send RST for the connection;
- `agent_filter` (Block List, Max: 1) (see [below for nested schema](#nestedblock--agent_filter))
- `challenge_cookie_name` (String) Set the cookie name used to send back to client. Default is sto-idd
- `challenge_interval` (Number) Specify the challenge interval. Default is 8 seconds
- `challenge_keep_cookie` (Number) Keep the challenge cookie from client and forward to backend. Default is do not keep
- `challenge_method` (String) 'http-redirect': http-redirect; 'javascript': javascript;
- `challenge_redirect_code` (String) '302': 302 Found; '307': 307 Temporary Redirect;
- `challenge_uri_encode` (Number) Encode the challenge phrase in uri instead of in http cookie. Default encoded in http cookie
- `disable` (Number) Disable this template
- `disallow_connect_method` (Number) Do not allow HTTP Connect method (asymmetric mode only)
- `filter_header_list` (Block List) (see [below for nested schema](#nestedblock--filter_header_list))
- `idle_timeout` (Number) Set the the idle timeout value in seconds for HTTP connections
- `ignore_zero_payload` (Number) Don't reset idle timer on packets with zero payload length from clients
- `malformed_http` (Block List, Max: 1) (see [below for nested schema](#nestedblock--malformed_http))
- `mss_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--mss_cfg))
- `multi_pu_threshold_distribution` (Block List, Max: 1) (see [below for nested schema](#nestedblock--multi_pu_threshold_distribution))
- `non_http_bypass` (Number) Bypass non-http traffic instead of dropping
- `out_of_order_queue_size` (Number) Set the number of packets for the out-of-order HTTP queue (asym mode only)
- `out_of_order_queue_timeout` (Number) Set the timeout value in seconds for out-of-order queue in HTTP (asym mode only)
- `post_rate_limit` (Number) Configure rate limiting for HTTP POST request
- `referer_filter` (Block List, Max: 1) (see [below for nested schema](#nestedblock--referer_filter))
- `request_header` (Block List, Max: 1) (see [below for nested schema](#nestedblock--request_header))
- `request_rate_limit` (Block List, Max: 1) (see [below for nested schema](#nestedblock--request_rate_limit))
- `response_rate_limit` (Block List, Max: 1) (see [below for nested schema](#nestedblock--response_rate_limit))
- `slow_read_drop` (Block List, Max: 1) (see [below for nested schema](#nestedblock--slow_read_drop))
- `use_hdr_ip_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--use_hdr_ip_cfg))
- `user_tag` (String) Customized tag
- `uuid` (String) uuid of the object

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--agent_filter"></a>
### Nested Schema for `agent_filter`

Optional:

- `agent_contains_cfg` (Block List) (see [below for nested schema](#nestedblock--agent_filter--agent_contains_cfg))
- `agent_ends_cfg` (Block List) (see [below for nested schema](#nestedblock--agent_filter--agent_ends_cfg))
- `agent_equals_cfg` (Block List) (see [below for nested schema](#nestedblock--agent_filter--agent_equals_cfg))
- `agent_filter_blacklist` (Number) Blacklist the source if the user-agent matches
- `agent_starts_cfg` (Block List) (see [below for nested schema](#nestedblock--agent_filter--agent_starts_cfg))

<a id="nestedblock--agent_filter--agent_contains_cfg"></a>
### Nested Schema for `agent_filter.agent_contains_cfg`

Optional:

- `agent_contains` (String)


<a id="nestedblock--agent_filter--agent_ends_cfg"></a>
### Nested Schema for `agent_filter.agent_ends_cfg`

Optional:

- `agent_ends_with` (String)


<a id="nestedblock--agent_filter--agent_equals_cfg"></a>
### Nested Schema for `agent_filter.agent_equals_cfg`

Optional:

- `agent_equals` (String)


<a id="nestedblock--agent_filter--agent_starts_cfg"></a>
### Nested Schema for `agent_filter.agent_starts_cfg`

Optional:

- `agent_starts_with` (String)



<a id="nestedblock--filter_header_list"></a>
### Nested Schema for `filter_header_list`

Required:

- `http_filter_header_seq` (Number) Sequence number

Optional:

- `http_filter_header_blacklist` (Number) Also blacklist the source when action is taken
- `http_filter_header_count_only` (Number) Take no action and continue processing the next filter
- `http_filter_header_regex` (String) Regex Expression
- `http_filter_header_unmatched` (Number) action taken when it does not match
- `http_filter_header_whitelist` (Number) Whitelist the source after filter passes, packets are dropped until then
- `user_tag` (String) Customized tag
- `uuid` (String) uuid of the object


<a id="nestedblock--malformed_http"></a>
### Nested Schema for `malformed_http`

Optional:

- `malformed_http_bad_chunk_mon_enabled` (Number) Enabling bad chunk monitoring. Default is disabled
- `malformed_http_enabled` (Number) Enabling ddos malformed http protection. Default value is disabled.
- `malformed_http_max_content_length` (Number) Set the maximum content-length header. Default value is 4294967295 bytes
- `malformed_http_max_header_name_size` (Number) Set the maxinum header name length. Default value is 64.
- `malformed_http_max_line_size` (Number) Set the maximum line size. Default value is 32512
- `malformed_http_max_num_headers` (Number) Set the maximum number of headers. Default value is 90
- `malformed_http_max_req_line_size` (Number) Set the maximum request line size. Default value is 32512


<a id="nestedblock--mss_cfg"></a>
### Nested Schema for `mss_cfg`

Optional:

- `mss_percent` (Number) Configure percentage of mss such that if a packet size is below the mss times mss-percent, packet is considered bad.
- `mss_timeout` (Number) Configure DDOS detection based on mss and packet size
- `number_packets` (Number) Specify percentage of mss. Default is 0, mss-timeout is not enabled.


<a id="nestedblock--multi_pu_threshold_distribution"></a>
### Nested Schema for `multi_pu_threshold_distribution`

Optional:

- `multi_pu_threshold_distribution_disable` (String) 'disable': Destination side rate limit only. Default: Enable;
- `multi_pu_threshold_distribution_value` (Number) Destination side rate limit only. Default: 0


<a id="nestedblock--referer_filter"></a>
### Nested Schema for `referer_filter`

Optional:

- `ref_filter_blacklist` (Number) Blacklist the source if the referer matches
- `referer_contains_cfg` (Block List) (see [below for nested schema](#nestedblock--referer_filter--referer_contains_cfg))
- `referer_ends_cfg` (Block List) (see [below for nested schema](#nestedblock--referer_filter--referer_ends_cfg))
- `referer_equals_cfg` (Block List) (see [below for nested schema](#nestedblock--referer_filter--referer_equals_cfg))
- `referer_starts_cfg` (Block List) (see [below for nested schema](#nestedblock--referer_filter--referer_starts_cfg))

<a id="nestedblock--referer_filter--referer_contains_cfg"></a>
### Nested Schema for `referer_filter.referer_contains_cfg`

Optional:

- `referer_contains` (String)


<a id="nestedblock--referer_filter--referer_ends_cfg"></a>
### Nested Schema for `referer_filter.referer_ends_cfg`

Optional:

- `referer_ends_with` (String)


<a id="nestedblock--referer_filter--referer_equals_cfg"></a>
### Nested Schema for `referer_filter.referer_equals_cfg`

Optional:

- `referer_equals` (String)


<a id="nestedblock--referer_filter--referer_starts_cfg"></a>
### Nested Schema for `referer_filter.referer_starts_cfg`

Optional:

- `referer_starts_with` (String)



<a id="nestedblock--request_header"></a>
### Nested Schema for `request_header`

Optional:

- `timeout` (Number)


<a id="nestedblock--request_rate_limit"></a>
### Nested Schema for `request_rate_limit`

Optional:

- `request_rate` (Number) HTTP request rate limit
- `uri` (Block List) (see [below for nested schema](#nestedblock--request_rate_limit--uri))

<a id="nestedblock--request_rate_limit--uri"></a>
### Nested Schema for `request_rate_limit.uri`

Optional:

- `contains_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--request_rate_limit--uri--contains_cfg))
- `ends_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--request_rate_limit--uri--ends_cfg))
- `equal_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--request_rate_limit--uri--equal_cfg))
- `starts_cfg` (Block List, Max: 1) (see [below for nested schema](#nestedblock--request_rate_limit--uri--starts_cfg))

<a id="nestedblock--request_rate_limit--uri--contains_cfg"></a>
### Nested Schema for `request_rate_limit.uri.contains_cfg`

Optional:

- `url_contains` (String) Request rate-limit HTTP URI containing a specified pattern
- `url_contains_rate` (Number) Request rate limit


<a id="nestedblock--request_rate_limit--uri--ends_cfg"></a>
### Nested Schema for `request_rate_limit.uri.ends_cfg`

Optional:

- `url_ends_with` (String) Request rate-limit HTTP URI ending with a specified pattern
- `url_ends_with_rate` (Number) Request rate limit


<a id="nestedblock--request_rate_limit--uri--equal_cfg"></a>
### Nested Schema for `request_rate_limit.uri.equal_cfg`

Optional:

- `url_equals` (String) Request rate-limit HTTP URI matching a specified pattern
- `url_equals_rate` (Number) Request rate limit


<a id="nestedblock--request_rate_limit--uri--starts_cfg"></a>
### Nested Schema for `request_rate_limit.uri.starts_cfg`

Optional:

- `url_starts_with` (String) Request rate-limit HTTP URI strting with a specified pattern
- `url_starts_with_rate` (Number) Request rate limit




<a id="nestedblock--response_rate_limit"></a>
### Nested Schema for `response_rate_limit`

Optional:

- `obj_size` (Block List, Max: 1) (see [below for nested schema](#nestedblock--response_rate_limit--obj_size))

<a id="nestedblock--response_rate_limit--obj_size"></a>
### Nested Schema for `response_rate_limit.obj_size`

Optional:

- `between_cfg` (Block List) (see [below for nested schema](#nestedblock--response_rate_limit--obj_size--between_cfg))
- `greater_cfg` (Block List) (see [below for nested schema](#nestedblock--response_rate_limit--obj_size--greater_cfg))
- `less_cfg` (Block List) (see [below for nested schema](#nestedblock--response_rate_limit--obj_size--less_cfg))

<a id="nestedblock--response_rate_limit--obj_size--between_cfg"></a>
### Nested Schema for `response_rate_limit.obj_size.between_cfg`

Optional:

- `obj_between1` (Number) Response size configuration
- `obj_between2` (Number) Response size configuration
- `obj_between_rate` (Number) Response rate limit


<a id="nestedblock--response_rate_limit--obj_size--greater_cfg"></a>
### Nested Schema for `response_rate_limit.obj_size.greater_cfg`

Optional:

- `obj_greater` (Number) Response size configuration
- `obj_greater_rate` (Number) Response rate limit


<a id="nestedblock--response_rate_limit--obj_size--less_cfg"></a>
### Nested Schema for `response_rate_limit.obj_size.less_cfg`

Optional:

- `obj_less` (Number) Response size configuration
- `obj_less_rate` (Number) Response rate limit




<a id="nestedblock--slow_read_drop"></a>
### Nested Schema for `slow_read_drop`

Optional:

- `min_window_count` (Number) Number of packets
- `min_window_size` (Number) minimum window size


<a id="nestedblock--use_hdr_ip_cfg"></a>
### Nested Schema for `use_hdr_ip_cfg`

Optional:

- `l7_hdr_name` (String) Set the http header name to parse for client ip. Default is X-Forwarded-For
- `use_hdr_ip_as_source` (Number) Mitigate on src ip specified by http header for example X-Forwarded-For header. Default is disabled


